<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Measuring electricity: Measuring electrocity project</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Measuring electricity<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Measuring electrocity project</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a>This project is final work of AVR course at Brno University of Technology</p>
<p><img src="images/real_connection.jpg" alt="image" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md1"></a>
Topic</h2>
<p>This project is a versatile and user-friendly system for measuring various electrical parameters, including voltage, capacitance, resistance, current. The primary focus is on applications such as solar panel and battery meters.</p>
<h2><a class="anchor" id="autotoc_md2"></a>
Team members</h2>
<ul>
<li>David Ecler (responsible for documentation)</li>
<li>Slávek Rylich (responsible for programming)</li>
<li>Jakub Chrástek (responsible for HW developer)</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Theoretical description and explanation</h1>
<p>System for measuring various electrical parameters such as voltage, capacitance, resistance and current. Used units are Arduino UNO, OLED display and measured components.</p>
<p>Arduino reads values on analog inputs. Using an ADC converter, it converts the measured value into a digital value using the following formula and prints it on the display:</p>
<p><img src="images/eq_adc_floor.png" alt="image" class="inline"/></p>
<p>There is only one ADC converter in Arduino. But it contains more channels between which this one converter can switch and converge the analog value from that channel. In our case, it converts 4 quantities voltage, capacitance, resistance and current, each connected to a separate analog input, see /schema/. In order to be able to measure all our parameters, it is necessary to switch channels so that the ADC value of the corresponding parameter is measured at every moment. This is achieved using a button. When pressed, the current channel changes to the next one and the next parameter is measured. The ADC conversion itself is required to convert the value periodically so that we are able to record the measured quantity over time. This is made possible by Timer0, which triggers the ADC conversion every 3ms. Completion of the conversion is captured by the interrupt vector for the ADC, from where the ADC values are recalculated to a specific range of given parameter.</p>
<p>The button press is captured by a rising edge on the INT0 pin, which causes the button press to be interrupted. Debouncer is solved by a time slot, within which it is possible to press the button only once.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
User control</h2>
<p>The user selects the measured quantity by pressing a button. It is also possible to start an automated measurement, when all quantities are measured simultaneously.</p>
<p><a href="https://github.com/SlavekRylich/DE2-electrocity-measuring-project/assets/124887798/bd2f5730-d17f-443b-8fa0-615e2d5840c4">https://github.com/SlavekRylich/DE2-electrocity-measuring-project/assets/124887798/bd2f5730-d17f-443b-8fa0-615e2d5840c4</a></p>
<h1><a class="anchor" id="autotoc_md5"></a>
Hardware description</h1>
<h2><a class="anchor" id="autotoc_md6"></a>
Voltage:</h2>
<p>The voltage measurement is performed according to the following circuit:</p>
<p><img src="images/voltage_measurement.png" alt="image" class="inline"/></p>
<p>Where 5V is the supply voltage from the Arudino uno. Furthermore, the circuit contains one 1kΩ resistor connected to ground and one variable value Ω resistor. The voltage is measured at pin A0, which is connected between the resistors in series.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Current:</h2>
<p>The current is measured using a current sensor. The sensor works by measuring the voltage, which it converts to an ADC. However, the current sensor has a 2.5V offset, which means that at 2.5V the current is 0A. and then it calculates either positive or negative depending on the voltage.</p>
<p><img src="images/current_measurement.png" alt="image" class="inline"/> This image is from internet website <a href="https://www.theengineeringprojects.com/">https://www.theengineeringprojects.com/</a>.</p>
<h2><a class="anchor" id="autotoc_md8"></a>
Capacitance:</h2>
<p>This method of measurement calculates how long it takes for the capacitor to reach 63.2% of its maximum voltage. Capacitance can be easily calculated by following formula : C = TC / R</p>
<ul>
<li>TC = time constant period in seconds</li>
<li>R = resistance in ohms</li>
<li>C = capacitance in farads (1 microfarad (ufd) = .000001 farad = 10^-6 farads )</li>
</ul>
<p>In the end, this measurement was heavily inaccurate due to part value tolarences and construction of board it self. So we measured 3 differently sized capacitors and according to the system of equations on line 319 of our code, we managed to achieve somewhat accurate results. On the oled display the value in uF is displayed with +-20uF accuracy.</p>
<p><img src="images/capacitance_measurement.png" alt="image" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md9"></a>
Resistance:</h2>
<p>We can simply measure resistance of unknown resistor via a voltage divider. Resistor with unknown value of resistance is connected 5V supply followed by 1kΩ resistor connected to GND. Port A3 is connected between these two resistors to read analog value called ADC. The analog value is represented by following formula :</p>
<p><img src="images/resistance_formula_pcq.png" alt="image" class="inline"/></p>
<p>Following formula is used to calculate the magnitude of the unknown resistance. In which UR1k represents the value of the ADC:</p>
<p><img src="images/resistance_formula.png" alt="image" class="inline"/></p>
<p><img src="images/resistance_measurement.png" alt="image" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md10"></a>
Software description</h1>
<p><img src="documentation/one_state.PNG" alt="image" class="inline"/></p>
<p><img src="documentation/state_diagram.PNG" alt="image" class="inline"/> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
